---
title: Create API Key
description: Create a new API key with auto-generated key value
---

# Create API Key üîí

Creates a new API key. The key value is automatically generated by the system.

## Endpoint
**POST** `/api/ApiKey/create`

<HeaderBadge 
  type="jwt" 
  icon="üîí" 
  label="JWT Required"
  :headers="['x-api-key: <your-api-key>', 'Authorization: Bearer <jwt-token>', 'Content-Type: application/json']"
/>

::: warning Authentication Required
üîí **JWT Required** - Both API key and JWT token are required
:::

## Request Example
```bash
curl -X POST https://shipyo.it/api/ApiKey/create \
  -H "x-api-key: ak_1234567890abcdef" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Mobile App API Key",
    "allowedIp": "192.168.1.200",
    "isActive": true,
    "description": "API key for mobile application integration"
  }'
```

## Request Body
```json
{
  "name": "Mobile App API Key",
  "allowedIp": "192.168.1.200",
  "isActive": true,
  "description": "API key for mobile application integration"
}
```

**Fields:**
- `name` (string, required): Human-readable name for the API key
- `allowedIp` (string, optional): IP address restriction (null for no restriction)
- `isActive` (boolean, required): Whether the API key should be active immediately
- `description` (string, optional): Description of the API key's purpose

## Success Response

<SuccessResponse 
  code="201" 
  title="API Key Created Successfully"
  description="New API key has been generated with secure random value"
  :example='{
    "success": true,
    "data": {
      "id": 3,
      "key": "ak_3456789012bcdef3456789012",
      "name": "Mobile App API Key",
      "isActive": true,
      "description": "API key for mobile application integration",
      "allowedIp": "192.168.1.200",
      "createdDate": "2024-08-25T15:30:00Z",
      "permissions": ["read", "write"],
      "tenantId": 1,
      "expiresAt": null
    },
    "message": "API Key created successfully"
  }'
>

### Response Fields

<div class="field-table">

| Field | Type | Description | Security Notes |
|-------|------|-------------|----------------|
| `success` | boolean | Always `true` for successful creation | Operation status |
| `data.id` | number | Unique API key identifier | Use for management operations |
| `data.key` | string | **ACTUAL API KEY VALUE** | ‚ö†Ô∏è Store securely - shown only once |
| `data.name` | string | Human-readable API key name | For identification purposes |
| `data.isActive` | boolean | API key activation status | Must be true to use |
| `data.description` | string | Purpose description | Documentation |
| `data.allowedIp` | string/null | IP address restriction | Security constraint |
| `data.createdDate` | string | ISO timestamp of creation | Audit information |
| `data.permissions` | array | Granted permissions | Access scope |
| `data.tenantId` | number | Associated tenant ID | Scope limitation |
| `data.expiresAt` | string/null | Expiration date | null = no expiration |
| `message` | string | Success confirmation | Human-readable message |

</div>

### üîí Critical Security Information

#### **API Key Value - First and Only Display**
- üö® **Store Immediately**: The `key` value is only shown **once** upon creation
- üîê **Secure Storage**: Store in environment variables or secure configuration
- ‚ùå **Cannot Retrieve**: You cannot get the full key value again later
- üîÑ **Regeneration**: If lost, you must create a new API key

#### **IP Address Restrictions**
- üåê **allowedIp**: If set, API key only works from this IP address
- üîì **null value**: No IP restriction (works from any IP - less secure)
- üõ°Ô∏è **Security recommendation**: Always set IP restrictions for production

#### **Immediate Usage**
```bash
# Test the newly created API key immediately
curl -X GET https://shipyo.it/api/Token/generate-from-apikey \
  -H "x-api-key: ak_3456789012bcdef3456789012"
```

### Post-Creation Actions

**Immediate steps required:**
1. üíæ **Save the key value** in your application's secure configuration
2. üß™ **Test the key** with a simple API call to verify it works
3. üìù **Document usage** in your deployment notes
4. üîç **Set up monitoring** for key usage patterns
5. üìÖ **Plan rotation** schedule for security best practices

### Important Notes

- **Tenant Scope**: API key is automatically associated with your current tenant
- **Permissions**: Inherit from your user role and tenant policies  
- **Activation**: Key is immediately active and ready to use
- **Management**: Use the returned `id` for future update/delete operations
- **Audit**: Key creation is logged for security monitoring

### Next Steps
1. **Store the key securely** in your application
2. **Update your application** to use the new API key
3. **Test all integrations** with the new key
4. **Monitor usage** through API logs
5. **Schedule regular rotation** for enhanced security

</SuccessResponse>

## Error Responses

<StatusCode 
  code="400" 
  title="Bad Request"
  description="Request contains invalid data or validation failures"
  :example='{"success": false, "message": "Validation failed", "errors": ["Name is required", "allowedIp must be a valid IP address"]}'
>

**Common validation errors:**
- Missing required `name` field
- API key name already exists within tenant
- Invalid IP address format in `allowedIp`
- Name contains invalid characters
- Description too long (if limits apply)

</StatusCode>

<StatusCode 
  code="401" 
  title="Unauthorized"
  description="Authentication credentials are missing or invalid"
  :example='{"success": false, "message": "API Key is missing.", "errors": ["Missing x-api-key header"]}'
>

**Authentication issues:**
- Missing `x-api-key` header
- Invalid API key value
- Missing `Authorization: Bearer <token>` header
- JWT token expired or invalid
- Malformed authentication headers

</StatusCode>

<StatusCode 
  code="403" 
  title="Forbidden"
  description="Valid credentials but insufficient permissions to create API keys"
  :example='{"success": false, "message": "Forbidden - Insufficient permissions", "errors": ["Cannot create API keys"]}'
>

**Permission issues:**
- User role does not allow API key creation
- Tenant-level API key creation restrictions
- Maximum API key limit reached for tenant
- Cross-tenant API key creation denied

</StatusCode>

<StatusCode 
  code="409" 
  title="Conflict"
  description="API key name already exists within the tenant"
  :example='{"success": false, "message": "API key name already exists", "errors": ["An API key with this name already exists"]}'
>

**Conflict scenarios:**
- Another API key in the same tenant has the same name
- Case-insensitive name collision
- Concurrent API key creation with same name

**Resolution:** Choose a different name or update the existing API key

</StatusCode>

<StatusCode 
  code="422" 
  title="Unprocessable Entity"
  description="Request violates business rules or system constraints"
  :example='{"success": false, "message": "API key limit exceeded", "errors": ["Tenant has reached maximum API key limit of 10"]}'
>

**Business rule violations:**
- Tenant has reached maximum API key limit
- IP address is in a blocked range
- Name violates naming conventions
- Requested permissions not available for tenant tier
- API key creation temporarily disabled for tenant

</StatusCode>

<StatusCode 
  code="500" 
  title="Internal Server Error"
  description="Unexpected server error during API key creation"
  :example='{"success": false, "message": "Internal server error", "errors": ["Failed to generate API key"]}'
>

**Possible causes:**
- Database connection failure
- API key generation service unavailable
- Cryptographic key generation errors
- Internal workflow failures

**Client action:** Retry the request or contact support if persistent

</StatusCode>

## Important Security Notes

### Key Generation
- API key values are automatically generated by the system
- Keys follow a secure format (e.g., `ak_` prefix + random string)
- Key values are cryptographically secure and unique

### First and Only Display
- ‚ö†Ô∏è **The full API key is only shown once upon creation**
- Store the key value securely immediately after creation
- You cannot retrieve the full key value later for security reasons

### IP Restrictions
- Use `allowedIp` to restrict API key usage to specific IP addresses
- Set to `null` or omit for no IP restriction (less secure)
- IP restrictions provide an additional security layer

## Best Practices

### Naming Convention
- Use descriptive names that indicate purpose
- Include environment (e.g., "Production Web App", "Dev Mobile")
- Avoid generic names like "API Key 1"

### Security Recommendations
- Set `allowedIp` when possible for enhanced security
- Create separate keys for different applications/environments
- Set `isActive: false` initially if key needs approval process
- Document the purpose in the `description` field

### Key Management
- Regularly audit and rotate API keys
- Deactivate unused keys promptly
- Monitor key usage through logs and analytics
- Implement key expiration policies when available

## Post-Creation Steps

After creating an API key:

1. **Save the Key**: Store the key value in your application's secure configuration
2. **Test the Key**: Verify the key works with a simple API call
3. **Document Usage**: Record where and how the key is being used
4. **Monitor Access**: Set up monitoring for key usage patterns
5. **Plan Rotation**: Schedule regular key rotation for security

## Example Usage After Creation

```bash
# Test the newly created API key
curl -X GET https://shipyo.it/api/User/getAll \
  -H "x-api-key: ak_3456789012bcdef3456789012" \
  -H "Authorization: Bearer your-jwt-token"
```
